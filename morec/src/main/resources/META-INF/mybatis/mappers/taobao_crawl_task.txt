<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.love.morec.taobao">

<resultMap type="TaobaoCrawlTask" id="taobaoCrawlTask">
	<id property="id" column="id"/>
	<result property="name" column="name"/>
	<result property="cid" column="cid"/>
	<result property="channel.name" column="classify"/>
	<result property="cron" column="cron"/>
	<result javaType="java.util.Enumeration" typeHandler="com.love.morec.morec.infrastruture.persist.impl.MybatisTaobaoCrawlTaskStatusTypeHandler" property="status" column="status"/>
</resultMap>

<sql id="commonSelect">
	select 
	self.id as id,
	self.name as name,
	self.cid as cid,
	self.status as status,
	self.classify as classify,
	self.cron as cron
	from cms_taobao_crawl_task self
</sql>

<insert id="save" keyProperty="id" useGeneratedKeys="true" >
	insert into cms_taobao_crawl_task(cid,name,status,classify,cron)
				values(#{cid},#{name},#{status},#{channel.name},#{cron})
</insert>
<select id="queryPage" resultMap="taobaoCrawlTask">
	<include refid="commonSelect"/>
	order by self.id
	 
</select>
<update id="update" >
	update cms_taobao_crawl_task
			set cid=#{cid},name=#{name},status=#{status},classify=#{channel.name},cron=#{cron}
			where id=#{id}
</update>
<update id="updateStatus" >
	update cms_taobao_crawl_task
			set status="STOPED"
</update>

<delete id="delete" >
	delete from cms_taobao_crawl_task where id=#{id}
</delete>
<delete id="deleteById" >
	delete from cms_taobao_crawl_task where id=#{id}
</delete>
<select id="get" resultMap="taobaoCrawlTask">
	<include refid="commonSelect"/>
	where self.id=#{id}
</select>
<select id="query" resultMap="taobaoCrawlTask">
	<include refid="commonSelect"/>
</select>
<select id="getsitename" resultType="String">
	select self.name from cms_taobao_crawl_task self
	where cid=#{cid}
</select>

</mapper>